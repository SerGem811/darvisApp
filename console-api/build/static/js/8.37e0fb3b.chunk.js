(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{131:function(e,t,a){"use strict";var n=a(0),r=a.n(n).a.createContext({sites:[],selectedSite:{},selectSite:function(){}});t.a=r},133:function(e,t,a){"use strict";var n=a(0),r=a.n(n).a.createContext({confirmationModal:{visible:!1,item:"",callback:function(){}},setConfirmationModal:function(){}});t.a=r},134:function(e,t,a){"use strict";a.d(t,"h",function(){return l}),a.d(t,"g",function(){return u}),a.d(t,"c",function(){return m}),a.d(t,"b",function(){return p}),a.d(t,"e",function(){return v}),a.d(t,"a",function(){return E}),a.d(t,"i",function(){return O}),a.d(t,"d",function(){return y}),a.d(t,"j",function(){return S}),a.d(t,"f",function(){return N});var n=a(1),r=a.n(n),c=a(10),i=a(15),o=a(14);function l(){return s.apply(this,arguments)}function s(){return(s=Object(c.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new i.a,e.abrupt("return",t.get(o.e).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return(d=Object(c.a)(r.a.mark(function e(t){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new i.a,e.abrupt("return",a.get(o.e,t).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=Object(c.a)(r.a.mark(function e(t){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new i.a,e.abrupt("return",a.post(o.e,t).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function p(e,t){return b.apply(this,arguments)}function b(){return(b=Object(c.a)(r.a.mark(function e(t,a){var n,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.a({headers:{contentType:"multipart/form-data"}}),(c=new FormData).append("plan",a.plan),c.append("name",a.name),c.append("image",a.image),e.abrupt("return",n.post("".concat(o.e,"/").concat(t,"/addLevel"),c).then(function(e){return e.data},function(e){throw e}));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function v(e,t){return h.apply(this,arguments)}function h(){return(h=Object(c.a)(r.a.mark(function e(t,a){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.a,e.abrupt("return",n.delete("".concat(o.e,"/").concat(t,"/addLevel"),a).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function E(e,t,a,n,r){return g.apply(this,arguments)}function g(){return(g=Object(c.a)(r.a.mark(function e(t,a,n,c,l){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new i.a,e.abrupt("return",s.post("".concat(o.e,"/").concat(t,"/addCamera"),{siteId:t,camera:a,level:n,cameraPoints:c,floorPlanPoints:l}).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(e,t,a,n,r){return j.apply(this,arguments)}function j(){return(j=Object(c.a)(r.a.mark(function e(t,a,n,c,l){var s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new i.a,e.abrupt("return",s.put("".concat(o.e,"/").concat(t,"/addCamera"),{siteId:t,camera:a,level:n,cameraPoints:c,floorPlanPoints:l}).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(e,t,a){return w.apply(this,arguments)}function w(){return(w=Object(c.a)(r.a.mark(function e(t,a,n){var c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=new i.a,e.abrupt("return",c.delete("".concat(o.e,"/").concat(t,"/addCamera/").concat(a),n).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function S(e,t){return k.apply(this,arguments)}function k(){return(k=Object(c.a)(r.a.mark(function e(t,a){var n;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new i.a,e.abrupt("return",n.put("".concat(o.e,"/").concat(a),t).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}function N(e){return x.apply(this,arguments)}function x(){return(x=Object(c.a)(r.a.mark(function e(t){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new i.a,e.abrupt("return",a.delete(o.e,t).then(function(e){return e.data},function(e){throw e}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}},135:function(e,t,a){"use strict";var n=a(38),r=a(0),c=a.n(r),i=a(160),o=a(161),l=a(162),s=a(128),u=a.n(s),d=a(142),m=a.n(d),f=function(e){var t=e.children,a=e.dark,r=e.className,s=e.bodyClass,d=e.actionHandler,f=e.header,p=Object(n.a)(e,["children","dark","className","bodyClass","actionHandler","header"]);return c.a.createElement(i.a,Object.assign({className:u()(m.a.card,r,a&&m.a.dark)},p),f&&c.a.createElement(o.a,{className:m.a.cardHeader},f,d),c.a.createElement(l.a,{className:s},t))};f.defaultProps={dark:!1,header:void 0,actionHandler:void 0},t.a=f},136:function(e,t,a){},137:function(e,t,a){"use strict";var n=a(0),r=a.n(n),c=a(5),i=a(9),o=a(395),l=a(396),s=a(397),u=a(398),d=a(399),m=a(400),f=a(401),p=a(402),b=a(403),v=a(27),h=a(28),E=(a(136),a(6)),g=a(131),O=function(){var e=r.a.useState(!1),t=Object(i.a)(e,2),a=t[0],n=t[1],c=localStorage.getItem("user")||{};c&&(c=JSON.parse(c));var O=c.role||{};return r.a.createElement("div",{className:"dar-navbar"},r.a.createElement(u.a,{className:"container",color:"faded",expand:"md"},r.a.createElement(d.a,{href:"/",className:"mr-auto"},r.a.createElement("img",{className:"dar-navbar__logo",src:"/images/logo-full.png",alt:"Darvis"})),r.a.createElement(m.a,{onClick:function(){return n(!a)}}),r.a.createElement(f.a,{isOpen:a,navbar:!0},r.a.createElement(g.a.Consumer,null,function(e){var t=e.selectedSite;return r.a.createElement(r.a.Fragment,null,t?function(e){return r.a.createElement(o.a,{className:"mr-auto",navbar:!0},Object(E.d)()&&r.a.createElement(l.a,{className:"dar-navbar__item"},r.a.createElement(v.c,{to:"/console/home",activeClassName:"link-active"},"Site")),Object(E.d)()&&e&&r.a.createElement(l.a,{className:"dar-navbar__item"},r.a.createElement(v.c,{to:"/console/site",activeClassName:"link-active"},e.name)),Object(E.d)()&&r.a.createElement(l.a,{className:"dar-navbar__item"},r.a.createElement(v.c,{to:"/console/cameras",activeClassName:"link-active"},"Cameras")),Object(E.d)()&&r.a.createElement(l.a,{className:"dar-navbar__item"},r.a.createElement(v.c,{to:"/console/explore",activeClassName:"link-active"},"Explore")),Object(E.d)()&&r.a.createElement(l.a,{className:"dar-navbar__item"},r.a.createElement(v.c,{to:"/console/analytics",activeClassName:"link-active"},"Analytics")),(Object(E.e)()||Object(E.c)())&&r.a.createElement(l.a,{className:"dar-navbar__item"},r.a.createElement(v.c,{to:"/console/admin/users",activeClassName:"link-active"},"Admin")))}(t):Object(E.d)()?r.a.createElement(o.a,{className:"mr-auto",navbar:!0},r.a.createElement(s.a,{color:"info",style:{marginBottom:"0",padding:"0.45rem 1.25rem 0.3rem"}},"Select a site to move ahead")):null)}),r.a.createElement("span",{className:"info"},"Hi \xa0",r.a.createElement("b",null,c.name,"\xa0"),r.a.createElement(p.a,{style:{padding:"5px 4px 4px 4px"},color:"dark"},O.name)),r.a.createElement(h.b,null,function(e){var t=e.logout;return r.a.createElement(b.a,{outline:!0,size:"sm",color:"dark",type:"submit",onClick:function(){return t()}},"logout")}))))},j=a(1),y=a.n(j),w=a(20),S=a(10),k=a(134),N=a(26),x=Object(c.f)(function(e){var t=e.history,a=e.children,c=Object(n.useContext)(N.b),o=JSON.parse(localStorage.getItem("selectedSite")),l=Object(n.useState)({selectedSite:o,reset:0,loading:!1}),s=Object(i.a)(l,2),u=s[0],d=s[1];return Object(n.useEffect)(function(){function e(){return(e=Object(S.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,d(function(e){return Object(w.a)({},e,{loading:!0})}),e.next=4,Object(k.g)(u.selectedSite._id);case 4:t=e.sent,d(function(e){return Object(w.a)({},e,{selectedSite:t,loading:!1})}),localStorage.setItem("selectedSite",JSON.stringify(t)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),d(function(e){return Object(w.a)({},e,{loading:!1})}),c.setError(e.t0,!0);case 13:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}u.selectedSite?function(){e.apply(this,arguments)}():t.push("/console/home")},[t,u.reset,c,d]),r.a.createElement(g.a.Provider,{value:{loading:u.loading,selectedSite:u.selectedSite,selectSite:function(e){d({selectSite:e}),localStorage.setItem("selectedSite",JSON.stringify(e)),t.push("/console/site")},reloadSites:function(){d(Object(w.a)({},u,{reset:u.reset+1}))}}},a)}),C=a(422),_=a(404),M=a(405),z=a(406),P=a(133),T={visible:!1,item:void 0,loading:!1,callback:function(){}},R=function(e){var t=e.children,a=Object(n.useState)(T),c=Object(i.a)(a,2),o=c[0],l=c[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(P.a.Provider,{value:{confirmationModal:o,setConfirmationModal:l,resetConfirmationModal:function(){return l(T)},setLoader:function(e){return l(Object(w.a)({},o,{loading:e}))}}},t),r.a.createElement(C.a,{style:{maxWidth:"250px"},isOpen:o.visible,toggle:function(){return l(Object(w.a)({},o,{visible:!o.visible}))}},r.a.createElement(_.a,null,"This will delete ",r.a.createElement("b",null,"".concat(o.item,", "))," Are you sure you want to?"),r.a.createElement(M.a,null,o.loading?r.a.createElement(z.a,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{color:"light",onClick:function(){return l(T)}},"No")," ",r.a.createElement(b.a,{color:"danger",onClick:function(){return o.callback()}},"Yes, Delete!!")))))};t.a=Object(c.f)(function(e){var t,a=e.match,n=e.children;return r.a.createElement(R,null,(t=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(O,null),r.a.createElement("div",{className:"container camera-system",style:{marginBottom:"30px"}},n))},a.path.includes("admin")?t():r.a.createElement(x,null,t())))})},142:function(e,t,a){e.exports={card:"styles_card__29RG3",dark:"styles_dark__3DC7d","online-status":"styles_online-status__R070A",cardHeader:"styles_cardHeader__10E2K"}},160:function(e,t,a){"use strict";var n=a(2),r=a(16),c=a(0),i=a.n(c),o=a(4),l=a.n(o),s=a(128),u=a.n(s),d=a(129),m={tag:d.l,inverse:l.a.bool,color:l.a.string,body:l.a.bool,outline:l.a.bool,className:l.a.string,cssModule:l.a.object,innerRef:l.a.oneOfType([l.a.object,l.a.string,l.a.func])},f=function(e){var t=e.className,a=e.cssModule,c=e.color,o=e.body,l=e.inverse,s=e.outline,m=e.tag,f=e.innerRef,p=Object(r.a)(e,["className","cssModule","color","body","inverse","outline","tag","innerRef"]),b=Object(d.h)(u()(t,"card",!!l&&"text-white",!!o&&"card-body",!!c&&(s?"border":"bg")+"-"+c),a);return i.a.createElement(m,Object(n.a)({},p,{className:b,ref:f}))};f.propTypes=m,f.defaultProps={tag:"div"},t.a=f},161:function(e,t,a){"use strict";var n=a(2),r=a(16),c=a(0),i=a.n(c),o=a(4),l=a.n(o),s=a(128),u=a.n(s),d=a(129),m={tag:d.l,className:l.a.string,cssModule:l.a.object},f=function(e){var t=e.className,a=e.cssModule,c=e.tag,o=Object(r.a)(e,["className","cssModule","tag"]),l=Object(d.h)(u()(t,"card-header"),a);return i.a.createElement(c,Object(n.a)({},o,{className:l}))};f.propTypes=m,f.defaultProps={tag:"div"},t.a=f},162:function(e,t,a){"use strict";var n=a(2),r=a(16),c=a(0),i=a.n(c),o=a(4),l=a.n(o),s=a(128),u=a.n(s),d=a(129),m={tag:d.l,className:l.a.string,cssModule:l.a.object,innerRef:l.a.oneOfType([l.a.object,l.a.string,l.a.func])},f=function(e){var t=e.className,a=e.cssModule,c=e.innerRef,o=e.tag,l=Object(r.a)(e,["className","cssModule","innerRef","tag"]),s=Object(d.h)(u()(t,"card-body"),a);return i.a.createElement(o,Object(n.a)({},l,{className:s,ref:c}))};f.propTypes=m,f.defaultProps={tag:"div"},t.a=f},254:function(e,t,a){"use strict";var n=a(2),r=a(16),c=a(0),i=a.n(c),o=a(4),l=a.n(o),s=a(128),u=a.n(s),d=a(129),m={className:l.a.string,cssModule:l.a.object,size:l.a.string,bordered:l.a.bool,borderless:l.a.bool,striped:l.a.bool,dark:l.a.bool,hover:l.a.bool,responsive:l.a.oneOfType([l.a.bool,l.a.string]),tag:d.l,responsiveTag:d.l,innerRef:l.a.oneOfType([l.a.func,l.a.string,l.a.object])},f=function(e){var t=e.className,a=e.cssModule,c=e.size,o=e.bordered,l=e.borderless,s=e.striped,m=e.dark,f=e.hover,p=e.responsive,b=e.tag,v=e.responsiveTag,h=e.innerRef,E=Object(r.a)(e,["className","cssModule","size","bordered","borderless","striped","dark","hover","responsive","tag","responsiveTag","innerRef"]),g=Object(d.h)(u()(t,"table",!!c&&"table-"+c,!!o&&"table-bordered",!!l&&"table-borderless",!!s&&"table-striped",!!m&&"table-dark",!!f&&"table-hover"),a),O=i.a.createElement(b,Object(n.a)({},E,{ref:h,className:g}));if(p){var j=Object(d.h)(!0===p?"table-responsive":"table-responsive-"+p,a);return i.a.createElement(v,{className:j},O)}return O};f.propTypes=m,f.defaultProps={tag:"table",responsiveTag:"div"},t.a=f},421:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(20),i=a(10),o=a(9),l=a(0),s=a.n(l),u=a(403),d=a(407),m=a(408),f=a(422),p=a(413),b=a(135),v=a(137),h=a(26),E=a(254),g=a(138),O=a(131),j=a(133),y=function(e){var t=e.sites,a=e.editAction,n=e.deleteSite,r=Object(l.useContext)(O.a),i=r.selectedSite,o=r.selectSite;return t&&t.length?s.a.createElement(E.a,{borderless:!0,responsive:!0},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"#"),s.a.createElement("th",null,"Name"),s.a.createElement("th",null,"User"),s.a.createElement("th",null,"Organization"),s.a.createElement("th",null,"Created"))),s.a.createElement("tbody",null,t.map(function(e,t){var r=!!i&&i._id===e._id;return s.a.createElement("tr",{key:e._id},s.a.createElement("th",{scope:"row"},t+1),s.a.createElement("td",null,e.name),s.a.createElement("td",null,e.user&&e.user.email),s.a.createElement("td",null,e.organization&&e.organization.name),s.a.createElement("td",null,e.created&&new Date(e.created).toDateString()),s.a.createElement("td",null,!r&&s.a.createElement(s.a.Fragment,null,s.a.createElement(u.a,{size:"sm",onClick:function(){return a(e)}},s.a.createElement(g.a,{icon:"edit"})),"\xa0",s.a.createElement(j.a.Consumer,null,function(t){var a=t.setConfirmationModal,r=t.resetConfirmationModal,i=t.setLoader;return s.a.createElement(u.a,{size:"sm",onClick:function(){return a(function(t){return Object(c.a)({},t,{visible:!0,item:e.name,callback:function(){i(!0),n(e._id,function(){return r()},function(){return i(!1)})}})})},color:"danger"},s.a.createElement(g.a,{icon:"trash"}))}),"\xa0"),!r&&s.a.createElement(u.a,{size:"sm",disabled:r,color:"success",onClick:function(){return o(e)}},"Select \xa0")))}))):s.a.createElement("div",null,"No Sites found")},w=a(156),S=a(247),k=a(404),N=a(409),x=a(410),C=a(411),_=a(412),M=a(405),z=a(406),P=a(148),T=a(18),R={name:P.string().min(3,"Min 3 Characters!!").max(50,"Max 50 allowed").required("Name Required"),organization:P.string().required("Organization not found"),user:P.string().required("User not found")},L=P.object().shape(R),A=function(e){var t=e.initialValues,a=e.addSite,n=e.updateSite,r=s.a.useState(!1),c=Object(o.a)(r,2),i=c[0],l=c[1],f=JSON.parse(localStorage.getItem("user"));f||(f={});var p={name:t.name||"",organization:f.organization?f.organization._id:"",user:f._id};return s.a.createElement(w.c,{initialValues:p,validationSchema:L,onSubmit:function(e,r){var c=function(){r.setSubmitting(!1),l(!1)};l(!0),t._id?n(e,t._id,function(){return c()},function(){return c()}):a(e,function(){return c()},function(){return c()})}},function(e){var a=e.values,n=e.isValid,r=e.isDirty,c=e.errors,o=e.handleSubmit,l=e.handleChange,p=e.handleBlur,b=e.isSubmitting;return s.a.createElement(S.a,{onSubmit:o},s.a.createElement(k.a,null,s.a.createElement(d.a,null,s.a.createElement(m.a,null,s.a.createElement("b",null,"User"),": \xa0 ",f.name),s.a.createElement(m.a,null,s.a.createElement("b",null,"Organization"),": \xa0 ",f&&!!f.organization&&f.organization.name)),s.a.createElement("br",null),s.a.createElement(d.a,null,s.a.createElement(m.a,null,s.a.createElement(N.a,null,s.a.createElement(x.a,{for:"name"},"Name"),s.a.createElement(C.a,{invalid:!!c.name,id:"name",tag:w.b,name:"name",onChange:l,onBlur:p,value:a.name}),s.a.createElement(w.a,{name:"name",component:"div"},function(e){return s.a.createElement(_.a,null,e)}))))),s.a.createElement(M.a,null,i?s.a.createElement(z.a,null):s.a.createElement(u.a,{type:"submit",color:"primary",size:"sm",disabled:b||!n||!!r},t._id?"Update":"Add"," Site")))})};A.defaultProps={initialValues:{},addSite:function(e){return T.a.info(e)},updateSite:function(e){return T.a.info(e)}};var H=A,D=a(134);t.default=function(){var e=Object(l.useState)({sites:[],reset:0,isLoading:!1}),t=Object(o.a)(e,2),a=t[0],n=t[1],E=Object(l.useState)({visible:!1,site:void 0}),g=Object(o.a)(E,2),O=g[0],j=g[1],w=Object(l.useState)(0),S=Object(o.a)(w,2),k=S[0],N=S[1],x=Object(l.useContext)(h.b).setError;Object(l.useEffect)(function(){function e(){return(e=Object(i.a)(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n(function(e){return Object(c.a)({},e,{isLoading:!0})}),e.prev=1,e.next=4,Object(D.h)();case 4:t=e.sent,n(function(e){return Object(c.a)({},e,{sites:t,isLoading:!1})}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),x(e.t0,!0),n(function(e){return Object(c.a)({},e,{isLoading:!1})});case 12:case"end":return e.stop()}},e,null,[[1,8]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[x,k]);var C=function(){var e=Object(i.a)(r.a.mark(function e(t,a,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(D.c)(t);case 3:a&&a(),N(k+1),j({visible:!1,site:void 0}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),n&&n(e.t0),x(e.t0,!0);case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n){return e.apply(this,arguments)}}(),_=function(){var e=Object(i.a)(r.a.mark(function e(t,a,n,c){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(D.j)(t,a);case 3:n&&n(),N(k+1),j({visible:!1,site:void 0}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),c&&c(e.t0),x(e.t0,!0);case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,a,n,r){return e.apply(this,arguments)}}(),M=function(){var e=Object(i.a)(r.a.mark(function e(t,a,n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(D.f)(t);case 3:a&&a(),N(k+1),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),n&&n(e.t0),x(e.t0,!0);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t,a,n){return e.apply(this,arguments)}}(),z=function(){return j(Object(c.a)({},O,{visible:!O.visible,site:void 0}))};return s.a.createElement(v.a,null,s.a.createElement(d.a,null,s.a.createElement(m.a,null,s.a.createElement(b.a,{header:"Sites",actionHandler:s.a.createElement(u.a,{size:"sm",color:"primary",className:"float-right",onClick:z},"Add Site")},a.isLoading?s.a.createElement("span",null,"Loading..."):s.a.createElement(y,{sites:a.sites,editAction:function(e){j(Object(c.a)({},O,{visible:!0,site:e}))},deleteSite:M})))),s.a.createElement(f.a,{isOpen:O.visible,toggle:z,style:{maxWidth:"650px"}},s.a.createElement(p.a,{toggle:z},O.site&&O.site._id?"Edit":"Add"," Site"),s.a.createElement(H,{initialValues:O.site,addSite:C,updateSite:_})))}}}]);
//# sourceMappingURL=8.37e0fb3b.chunk.js.map